# GO Language Support

You can quickly build a sample Go app into a runnable OCI image on your local machine with SecurePacks.
### Build a Sample Go Application:-

1. Clone the SecurePacks samples repository and navigate to a Go sample app :
```
git clone https://github.com/initializ-buildpacks/samples
```
```
cd samples/go/mod
```
2. Use the pack CLI with the SecurePacks Go Buildpack to build the sample app :
```
pack build my-app \
 --buildpack initializ-buildpacks/go \
 --builder initializbuildpacks/securepacks
```
3. Follow the instructions in the app's README to run the app :
 ```
 docker run --interactive --tty --env PORT=8080 --publish 8080:8080 mod-sample
 ```
4. Test you go-app on :
 ```
 http://localhost:8080
 ```
 ### Override the Detected Go Version:-
 You can override the detected Go version by setting the BP_GO_VERSION environment variable at build time
1. With pack and a Command-Line Flag:
 ```
 pack build my-app --buildpack initializ-buildpacks/go --env BP_GO_VERSION="1.21.9" --builder initializbuildpacks/securepacks
```
2. With pack and a project.toml file: put this project.toml file in you root directory : 
#### project.toml
```
[ _ ]
schema-version = "0.2"
 
[[ io. .build.env ]]
  name="BP_GO_VERSION"
  value="1.21.9"
  ```
The pack CLI will automatically detect the project file at build time.
  
3. Configure the `go build` Command:
 #### With pack and a Command-Line Flag
- Set `-ldflags` for `go build`:
  When building, use the `--env` flag to set `BP_GO_BUILD_LDFLAGS`. For example, if you want to add `-ldflags="-X main.variable=some-value"` to the build flagset, set the environment variable accordingly:
```
pack build my-app --buildpack initializ-buildpacks/go --env BP_GO_BUILD_LDFLAGS="-X main.variable=some-value" --builder initializbuildpacks/securepacks
```
#### With pack and a project.toml
When building with the pack CLI, create a project.toml(opens in a new tab) file in your app directory that sets BP_GO_BUILD_LDFLAGS at build time. For example, to add -ldflags="-X main.variable=some-value" to the build flagset, set the environment variable as follows:
```
# project.toml
[ _ ]
schema-version = "0.2"

[[ io.buildpacks.build.env ]]
  name="BP_GO_BUILD_LDFLAGS"
  value="-X main.variable=some-value"
  ```

### Enable Process Reloading:-
Your Go binary is typically the only process running in your app container. If you want to restart the binary process when files in your app's working directory change, you can enable this feature. It can help you quickly see the effects of code changes. You can use this feature alongside a development orchestrator like Tilt.
#### Using BP_LIVE_RELOAD_ENABLED
To enable reloadable processes, set the $BP_LIVE_RELOAD_ENABLED environment variable at build time, either by passing a flag to the platform(opens in a new tab) or by adding it to your project.toml.
#### With a pack build flag
```bash
pack build myapp --buildpack initializ-buildpacks/go --env BP_LIVE_RELOAD_ENABLED=true --builder initializbuildpacks/securepacks
```
#### In a project.toml file
```
[ _ ]
schema-version = "0.2"

[[ io.buildpacks.build.env ]]
  name = 'BP_LIVE_RELOAD_ENABLED'
  value = 'true'
```
### Override the Start Process Set by the Buildpack
 
Initializ users can customize process types using a Procfile. The Procfile should be at the root of the app and follow this format: (type): (command). If a language buildpack lacks Procfile support, it can be added at runtime.
To add a process named "hello" and set it as the default:
```
echo "hello: echo hello world" > Procfile
```
```
pack build my-app \
  --buildpack initializ-buildpacks/go \
  --buildpack initializ-buildpacks/procfile \
  --default-process hello \
  --builder initializbuildpacks/securepacks
```
```
docker run samples/nodejs # should print "hello world"
```
 
### Set Environment Variables for App Launch Time
 
Embed launch-time environment variables in your app image if you're using the Go buildpack. Refer to the documentation for the [Environment Variables](https://github.com/initializ-buildpacks/environment-variables/blob/main/README.md) Buildpack.
 
### Extract Go Module Information From A Build
The Go buildpack generates a software bill of materials (SBOM) for the dependencies installed in the app image during a build. You can extract information about the Go modules used in the build using the build-time SBOM.
 
With pack and a Command-Line Flag .
When using the pack CLI, use the flag --sbom-output-dir to extract SBOMs from the build:
```
pack build my-app --buildpack initializ-buildpacks/go --sbom-output-dir /tmp/sbom-output --builder initializbuildpacks/securepacks
```
To view the Go modules used in the build, inspect one of the SBOMs generated by the Go Mod Vendor buildpack.
```
cat /layers/sbom/launch/sbom.legacy.json
```
 
### Enable DEBUG logging
 
If you're using the Go buildpack, you can access extra debug logs during the image build process by setting the BP_LOG_LEVEL environment variable to DEBUG during the build:
```
pack build my-app --buildpack initializ-buildpacks/go --env BP_LOG_LEVEL=DEBUG --builder initializbuildpacks/securepacks